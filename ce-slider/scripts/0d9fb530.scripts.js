"use strict";angular.module("ceSlider",[]),angular.module("ceSlider").controller("MainCtrl",["$scope",function(a){a.testData=[0,1,2,3,4,5,6,7,8,9]}]),angular.module("ceSlider").directive("ceSlider",["$document","$timeout",function(){return{templateUrl:"partials/ceSlider.html",restrict:"E",scope:{model:"=ceModel",modelMax:"=ceModelMax",data:"=ceData",snap:"=ceSnap",ticks:"@ceTicks",touchingClass:"@ceTouchingClass",draggingClass:"@ceDraggingClass",dragAreaClass:"@ceDragAreaClass",labelClass:"@ceLabelClass",labelMaxClass:"@ceLabelMaxClass",dragHandleClass:"@ceDragHandleClass",dragHandleMaxClass:"@ceDragHandleMaxClass",tickContainerClass:"@ceTickContainerClass",tickClass:"@ceTickClass",touchingClassOutDelay:"@ceTouchingClassOutDelay",draggingClassOutDelay:"@ceDraggingClassOutDelay",dragHandleContent:"@ceDragHandleContent",dragHandleMaxContent:"@ceDragHandleMaxContent",dragHandleOverlapClass:"@ceDragHandleOverlapClass",dragHandleOverlapMaxClass:"@ceDragHandleOverlapMaxClass"},link:function(a,b){function c(){clearTimeout(d),d=setTimeout(function(){for(var a=0,b=g.length;b>a;a++)g[a].triggerHandler("updatePosition")},250)}if(!a.data)throw new Error("Do you even data, bro?");a.touchingClass=a.touchingClass||"touching",a.draggingClass=a.draggingClass||"dragging",a.dragAreaClass=a.dragAreaClass||"drag-area",a.labelClass=a.labelClass||"value-label",a.labelMaxClass=a.labelMaxClass||"value-label-max",a.dragHandleClass=a.dragHandleClass||"drag-handle",a.dragHandleMaxClass=a.dragHandleMaxClass||"drag-handle-max",a.tickContainerClass=a.tickContainerClass||"tick-container",a.tickClass=a.tickClass||"tick",a.touchingClassOutDelay=parseInt(a.touchingClassOutDelay)||0,a.draggingClassOutDelay=parseInt(a.draggingClassOutDelay)||0,a.tickCount=0;var d,e=!1;if(a.ticks&&parseInt(a.ticks)?(e=!0,a.tickCount=parseInt(a.ticks)):a.ticks&&a.data&&a.data.length&&(e=!0,a.tickCount=a.data.length),e)for(var f=0;f<a.tickCount;f++)b.find("span").append('<div class="'+a.tickClass+'" style="left:'+100/a.tickCount*f+'%;"></div>');var g=function(){for(var c=[],d=b.children().children(),e=0,f=d.length;f>e;e++)angular.element(d[e]).attr(a.dragHandleClass)&&(c[c.length]=angular.element(d[e]));return c}();a.container=angular.element(b.children()[0]),a.handle=g[0],a.minPossible=Math.min.apply(null,a.data),a.$parent[a.model]=a.minPossible,a.handleMax=g[1],a.maxPossible=Math.max.apply(null,a.data),a.$parent[a.modelMax]=a.maxPossible,window.onresize=c}}}]).directive("dragHandle",["$document","$timeout",function(a,b){return{restrict:"A",scope:{type:"@dragHandle",snap:"=ceSnap",touchingClass:"=ceTouchingClass",draggingClass:"=ceDraggingClass",touchingClassOutDelay:"=ceTouchingClassOutDelay",draggingClassOutDelay:"=ceDraggingClassOutDelay",dragHandleOverlapClass:"=ceDragHandleOverlapClass",dragHandleOverlapMaxClass:"=ceDragHandleOverlapMaxClass"},link:function(c,d){function e(a){var b=d[0];if(b.currentStyle)var c=b.currentStyle[a];else if(window.getComputedStyle)var c=document.defaultView.getComputedStyle(b,null).getPropertyValue(a);return c}function f(a){return a.touches&&a.touches[0]&&a.touches[0].pageX?a.touches[0].pageX:0}function g(){r=j(d.css("left").replace("%","")),a.triggerHandler("mousedown"),a.triggerHandler("mousemove"),a.triggerHandler("mouseup")}function h(b){b.preventDefault(),d.addClass(c.touchingClass),q=(b.screenX||b.pageX||f(b))-r,a.on("mousemove",k),a.on("mouseup",l),a.on("touchmove",k),a.on("touchend",l)}function i(a){return a/c.$parent.container[0].clientWidth*100}function j(a){return a*c.$parent.container[0].clientWidth/100}function k(a){d.addClass(c.draggingClass),clearTimeout(p),p=setTimeout(function(){d.removeClass(c.draggingClass)},c.draggingClassOutDelay);var e=(a.screenX||a.pageX||f(a))-q,g=i(e),h=j(m.css("left").replace("%","")),k=j(n.css("left").replace("%",""));if(g>=0&&100>=g?("min"==c.type&&k>=e?r=e:"min"==c.type&&e>=k&&(r=k),"max"==c.type&&e>=h?r=e:"max"==c.type&&h>=e&&(r=h)):0>g&&"min"==c.type?r=0:g>100&&"max"==c.type&&(r=j(100)),c.snap){var l=Math.round(c.$parent.data.length*i(r)/100.01);r=s[l]?s[l].offsetLeft:j(100)}d.css({left:i(r)+"%"}),b(function(){c.$parent[c.model]=c.$parent.data[Math.floor(c.$parent.data.length*i(r)/100.01)],c.value=c.$parent[c.model]},0),m[0].offsetWidth+m[0].offsetLeft>=n[0].offsetLeft?(m.addClass(c.dragHandleOverlapClass),n.addClass(c.dragHandleOverlapClass),n.addClass(c.dragHandleOverlapMaxClass)):(m.removeClass(c.dragHandleOverlapClass),n.removeClass(c.dragHandleOverlapClass),n.removeClass(c.dragHandleOverlapMaxClass))}function l(){clearTimeout(o),o=setTimeout(function(){d.removeClass(c.touchingClass)},c.touchingClassOutDelay),clearTimeout(p),p=setTimeout(function(){d.removeClass(c.draggingClass)},c.draggingClassOutDelay),a.off("mousemove",k),a.off("mouseup",l),a.off("touchmove",k),a.off("touchend",l)}var m,n,o,p,q=0,r=0,s=[];"max"==c.type?(d.css({left:"100%"}),b(function(){r=d[0].offsetLeft-parseInt(e("margin-left")),q=r},0),c.model="modelMax"):c.model="model",b(function(){c.$parent[c.model]=c.$parent.data[Math.floor(c.$parent.data.length*i(r)/100.01)],c.value=c.$parent[c.model],m=c.$parent.handle,n=c.$parent.handleMax},0),c.snap&&b(function(){s=d.parent().children().children()},100),d.on("updatePosition",g),d.on("mousedown",h),d.on("touchstart",h),c.$watch(function(){return c.snap},function(){g()})}}}]);