"use strict";angular.module("rangesApp",["ngRoute","ngSanitize","ngSlider"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("rangesApp").controller("MainCtrl",["$scope","$filter","$timeout","$compile","Stocks",function(a,b,c,d,e){a.stocksProvider=e,a.userRange={min:0,max:1e4},a.getRange=function(b){var c=[];return angular.forEach(a.stocksProvider.getResults(),function(a){c.push(a[b])}),c.sort(function(a,b){return a-b}),c},a.filteredStocks=function(){function c(b){return b>=a.userRange.min&&b<=a.userRange.max?!0:!1}var d=b("filter")(a.stocksProvider.getResults(),function(a){return c(a.YearLow)||c(a.YearHigh)?(a.inRange=!0,!0):(a.inRange=!1,!1)});return d},a.generateRanges=function(){a.stockRange={min:a.getRange("YearLow")[0],max:a.getRange("YearHigh")[a.getRange("YearHigh").length-1]},a.sliderValue="0;"+a.stockRange.max,a.sliderOptions={from:0,to:a.stockRange.max,step:.1,dimension:" $"}},a.$watch(function(){return a.sliderValue},function(b){a.userRange.min=b.split(";")[0],a.userRange.max=b.split(";")[1]},!0),a.$watch(function(){return a.stocksProvider.getResults()},function(b,c){c&&b.length==c.length||(a.generateRanges(),$("#sliderContainer").html(""),$("#sliderContainer").html(d('<input ng-model="sliderValue"  type="text" id="slider" slider options="sliderOptions" />')(a)))},!0),a.generateRanges()}]),angular.module("rangesApp").service("Stocks",["$http","$q",function(a,b){function c(){return"http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quote%20where%20symbol%20in%20("+e(f)+")&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback="}function d(){var d=b.defer();return a({method:"GET",url:c()}).success(function(a){a&&a.query&&a.query.results&&a.query.results.quote?(a.query.results.quote.length||(a.query.results.quote=[a.query.results.quote]),angular.forEach(a.query.results.quote,function(b,c){b.YearLow&&b.YearHigh?(b.YearLow=parseFloat(b.YearLow),b.YearHigh=parseFloat(b.YearHigh)):(a.query.results.quote.splice(c,1),f.splice(f.indexOf(b.symbol),1))}),h=a.query.results.quote,d.resolve()):d.reject()}).error(function(){h=[],d.reject(arguments)}),d.promise}var e=function(){return'"'+f.join('","')+'"'},f=["GOOG","MSFT","F","BAC","AMD","JPM","EMC","WFC","JCP","GE","GME","T","S","NVR","MA","GHC","V","MKL"],g={query:{count:2,created:"2014-01-14T22:56:17Z",lang:"en-US",results:{quote:[{symbol:"GOOG",AverageDailyVolume:"1837970",Change:"+26.42",DaysLow:"1128.09",DaysHigh:"1151.00",YearLow:695.52,YearHigh:1147.3199,MarketCapitalization:"384.0B",LastTradePriceOnly:"1149.40",DaysRange:"1128.09 - 1151.00",Name:"Google Inc.",Symbol:"GOOG",Volume:"2482553",StockExchange:"NasdaqNM"},{symbol:"MSFT",AverageDailyVolume:"40892700",Change:"+0.80",DaysLow:"34.63",DaysHigh:"35.88",YearLow:26.83,YearHigh:38.98,MarketCapitalization:"298.7B",LastTradePriceOnly:"35.78",DaysRange:"34.63 - 35.88",Name:"Microsoft Corpora",Symbol:"MSFT",Volume:"41623260",StockExchange:"NasdaqNM"}]}}},h=g.query.results.quote;return d(),{update:function(a){return a&&"object"==typeof a&&a.length&&a.length>0&&angular.forEach(a,function(a){"string"==typeof a&&-1==f.indexOf(a)&&f.push(a)}),d()},symbols:{get:function(){return f},remove:function(a){return"string"==typeof a&&-1!=f.indexOf(a)&&f.splice(f.indexOf(a),1),d()}},getResults:function(){return h}}}]);